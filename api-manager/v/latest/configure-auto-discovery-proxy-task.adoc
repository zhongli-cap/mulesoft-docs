= To Configure a Proxy for Auto-Discovery (Nov 2017)

In Mule 4 Early Access, auto-deployment isn't supported. If you select Mule 4 Runtime in the configuration of an API instance, download a WSDL, RAML, or HTTP proxy from API Manager, and configure it. In this procedure, you modify the proxy config.properties file your API configuration in API Manager. 

. If you have not already created a WSDL, RAML, or HTTP asset in Exchange, create a new asset. See link below.
. In API Manager > Manage API > Manage API from Exchange, configure management of the asset. See link below. Specify that you're using Mule 4 by checking this box: Check This Box If You Are Managing This Api In Mule 4.
. Save the configuration and download the proxy. See link below.
. After downloading the proxy in API Manager, run the following command:
+
`unzip proxy.jar -d proxyFolder`
+
The proxy.jar and proxyFolder represent the name and location of the downloaded JAR.
. Configure properties in config.properties as described in the following WSDL, RAML, or HTTP sections.
. Regenerate the JAR using the following command:
+
`zip -r configuredProxy.jar proxyFolder`
+
Include all files _within_ the folder, but do _not_ include the root proxyFolder; otherwise, Mule Runtime rejects the app.


== WSDL

In this example, the properties in config.properties are service.name, service.name, service.port and the WSDL location is `+http://tshirt-service.cloudhub.io/?wsdl+`.

image::mule4-proxy-wsdl.png[]


. In the config.properties file in proxyFolder, include the configuration information from API Manager > API Administration > instance name.
+
* api.id
+
The ID, generated by API Manager, of new APIs managed by API Manager. The API ID is displayed on the API instance dashboard.
+
* proxy.path
+
Default value: /
+
* proxy.port
+
Default value: 8081
+
* proxy.responseTimeout
+
The time that the proxy can wait until it times out. Default value: 10000 ms
+
* wsdl
+
The location of your wsdl spec, for example an url. Don’t forget to append the query string “?wsdl” at the end of it. 
* service.namespace
+
The target namespace of your web service.
+
* service.name
+
The name of the service the proxy represents. This proxy supports only one service.
+
* service.port
+
The name of the port for the service the proxy represents. This proxy supports only one port. 
+
. Regenerate the JAR as described above.

== RAML

. In the config.properties file in proxyFolder, include the configuration information from API Manager > API Administration > instance name.
+
* api.id
+
The ID, generated by API Manager, of new APIs managed by API Manager. The API ID is displayed on the API instance dashboard.
+
* proxy.path
+
Default value: /
+
* proxy.port
+
Default value: 8081
+
* proxy.responseTimeout
+
The time that the proxy can wait until it times out. Default value: 10000 ms
+ 
* raml
+
The location of your raml spec. You have to attach your raml spec to the proxy and provide a relative or absolute location of the root raml file. The raml files must be inside the /api folder of your application. 
. Check the exportedResources list in the mule-artifact.json file to make sure the proxy exports all the dependent files of the API specification.
. If there are any missing files, add them to the mule-artifact.json.
+
image::mule-artifact.png[]
+
. Regenerate the JAR as described above.

== HTTP

In the https proxy, the keystore should be inside of the root folder of your app.

. In the config.properties file in proxyFolder, include the configuration information from API Manager > API Administration > instance name.
+
* api.id
+
The ID, generated by API Manager, of new APIs managed by API Manager. The API ID is displayed on the API instance dashboard.
+
* proxy.path
+
Default value: /
+
* proxy.port
+
Default value: 8081
+
* proxy.responseTimeout
+
The time that the proxy can wait until it times out. Default value: 10000 ms
+
. Regenerate the JAR as described above.

== See Also

* link:/anypoint-exchange/to-create-an-asset#creating-an-api-asset[Create a new WSDL asset]
* link:/api-manager/manage-exchange-api-task[Configure management of the asset]
* link:/api-manager/download-proxy-task[To Download a Proxy]
* link:/api-manager/find-api-id-task[To Find the API ID of an API]


