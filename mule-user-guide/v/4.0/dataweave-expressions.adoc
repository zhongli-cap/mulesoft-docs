= DataWeave
:keywords: studio, anypoint, transform, transformer, format, aggregate, rename, split, filter convert, xml, json, csv, pojo, java object, metadata, dataweave, data weave, datawave, datamapper, dwl, dfl, dw, output structure, input structure, map, mapping

image:dw-logo.png[dw]

== DataWeave Expressions



In AnyPoint Studio, DataWeave expressions are written according to the following format: `#[expression]`.

In Design Center, the expressions you type into the UI lack the hash and square brackets: `expression`.

If you export a Mule application to AnyPoint Studio, the XML output in the `mule-config.xml` file uses the AnyPoint Studio format.

DataWeave expressions are influenced by their context, including by metadata about input and output data – its format, structure, and so on – which are stored in attributes and variables of the Mule message object.

For DataWeave transformations, a header section allows you to specify custom properties, but this part of the expression is *optional*, as these properties default to whatever fits the contextual metadata best.

////
If you're already familiar with Java, learning DataWeave is not difficult. That said, it's important to comprehend some Mule-specific details _before_ you learn how to apply DataWeave expressions in your application.

. *Understand the Mule message structure.* Because you use DataWeave to act upon the contents of a Mule event object (payload, attributes and variables), you first need to understand the basic structure of the Mule event. If you are not already familiar with it, read about the link:/mule-user-guide/v/4.0/mule-concepts[Mule concepts].

. *Understand how to see the contents of the Mule event.* To be able to act upon it, you need to be able to figure out what type of data it contains. Is the payload an array? Are there any variables? What properties exist? The link:/getting-started/mule-message[Mule Message Tutorial] describes the tools you can use to see inside the message, so that you know how to use DataWeave expressions to manipulate the data.

+
////



== Using DataWeave

Based on information that's extracted from the Mule event and environment properties at runtime, Mule evaluates expressions to complete different types of tasks:

* *Extract* information: 
** `#[payload]`
** `#[attributes.propertyName]`
** `#[myVariableName]`
** `#[sizeOf payload.shoppingCart.items]`
+
[TIP]
For a full reference about how to extract different values with Dataweave, see link:/mule-user-guide/v/4.0/to-extract-values-using-dataweaves[To Extract Values With Dataweave].

* *Evaluate* conditions:
** `#[payload.age > 21]`
** `#[attributes.locale  ==  'en_us']`
+
The example below evaluates part of the payload to forward requests to different flows.
+
[source, xml, linenums]
----
<choice>
  <when expression="#[payload.purchaseType == 'book']">
    <flow-ref name="flow1"/>
  </when>
  <when expression="#[payload.purchaseType == 'mp3']">
   <flow-ref name="flow2"/>
  </when>
</choice>
----

* *Transform* the message.
** `#[payload: shirtSizeArray ++ "XXL" ]`
** `#[payload.name: upper payload.name]`
+
The example below cycles through an array of objects, and sets "size" to upper case in each. It then filters to only those where the "count" field is not 0.
+
[source,DataWeave, linenums]
----
%dw 1.0
%output application/json
---
shirts: payload map {
    size: upper $.size,
    count: $.count
}
filter $.count > 0
----

== The Transform Component

The *Transform* component allows you to use the language to query and transform data through DataWeave. Any mappings you perform through the graphical interface are also expressed in DataWeave code in real-time and vice-versa.
////
* link:link:/anypoint-studio/v/7/using-dataweave-in-studio[Graphically map] fields by dragging one attribute to another
* Implement this component through link:/mule-user-guide/v/4.0/dataweave-xml-reference[XML]
////
== Auto-Complete

If you are configuring a field that supports expressions and need help with syntax, you can access DataWeave suggestions by one of two methods.

* Place your cursor inside the brackets in a field that has `#[]` pre-populated for you, then press Ctrl + Space Bar.
* Enter `#[` to open a new DataWeave expression and display suggestions, as shown below.
+
image:auto_complete.png[auto_complete]
+
[NOTE]
Note that the autocomplete functionality described here works in the *Visual Editor only*. Although Studio's XML tab does offer some autocomplete options, the suggestions there are limited by Eclipse and are not based on DataSense or DataWeave.

== Additional Tips

* DataWeave performs link:http://en.wikipedia.org/wiki/Type_coercion[type coercion] at runtime. 
* When writing in Studio's XML editor, you cannot use double quotes to express String literals, because DataWeave expressions already appear enclosed in double quotes in configuration files. Instead, you can either: +
** use single quotes                   `('expression')`
** escape quotes with &quot;      `(&quot;expression&quot;)`
** escape quotes with \u0027      `(\u0027expression\u0027)`
+
If you're writing on Studio's visual editor, Studio transforms double quotes into escaped quotes `(&quot;) `in the XML view.


== DataWeave Reference Material

////
* link:/mule-user-guide/v/4.0/dataweave-quickstart[DataWeave Quickstart Guide]
* link:/mule-user-guide/v/4.0/dataweave-xml-reference[DataWeave XML Reference]
////
* link:mule-user-guide/v/4.0/mule-concepts[Mule Concepts]

* link:/mule-user-guide/v/4.0/dataweave-language-introduction[DataWeave Language Introduction]
* link:/mule-user-guide/v/4.0/dataweave-examples[DataWeave Examples]
* link:/mule-user-guide/v/4.0/dataweave-operators[DataWeave Operators]
* link:/mule-user-guide/v/4.0/dataweave-types[DataWeave Types]
* link:/mule-user-guide/v/4.0/dataweave-formats[DataWeave Formats]
* link:/mule-user-guide/v/4.0/dataweave-selectors[DataWeave Selectors]
////
* link:/mule-user-guide/v/4.0/dataweave-memory-management[DataWeave Memory Management]
* link:/mule-user-guide/v/4.0/dataweave-flat-file-schemas[DataWeave Flat File Schemas]
////
* link:/mule-user-guide/v/4.0/dataweave-troubleshooting[Troubleshooting Dataweave]
