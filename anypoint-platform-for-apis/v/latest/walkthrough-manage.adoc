= Manage an API
:keywords: api, gateway, sla, policy, raml, portal, manage

After deploying T-Shirt Ordering Service API or its proxy, as an API Version Owner you can manage an API using policies and SLA tiers. In this walkthrough, you create two access tiers:

*  A tier that accepts any developer who wants to use the API, but limits applications from the user/developer to three requests per minute, and rejects additional requests.
* A tier for a premium access level that accepts up to five per minute and requires API Version Owner approval of the user who wants to access the API.

API Manager sends an email to the API Version Owner when a user/developer calls signs up for premium access.

In this walkthrough, you also apply SLA-based policies to handle requests that exceed SLA limits that you added in the previous procedure.

* Throttling - SLA-based
+
Stores excessive requests in a queue for processing later.
* Rate Limiting - SLA-based
+
Discards excessive requests.

This walkthrough uses features that might not be visible or accessible to you, depending on link:/release-notes/anypoint-platform-for-apis-release-notes#april-2016-release[entitlements you purchased].

To add SLA tiers:

. On the API version details page, click the *SLA Tiers* tab.
+
image::walkthrough-manage-afcf8.png[walkthrough-manage-afcf8,height=515,width=515]
+
The *Add SLA tier* dialog appears.
+
. Click *Add SLA Tier*.
+
. Fill in the fields as follows:
+
* *Name*: Free
* *Approval*: Automatic
* *Throughput requests*: 3
* *Throughput time period*: Minute
+
image::walkthrough-manage-ae5a4.png[walkthrough-manage-ae5a4,height=631,width=598]
+
. Click *Add*.
+
. On the API version details page, click *Add SLA Tier* again, and fill in the fields as follows:
+
* *Name*: Premium
* *Approval*: Manual
* *Throughput requests*: 5
* *Throughput time period*: Minute

To apply policies:

. Click the *Policies* tab.
+
The list of available policies appears.
+
. Click `>` to get the status and description of a policy.
+
image::walkthrough-manage-0994c.png[walkthrough-manage-0994c,height=453,width=800]
+
. Click *Apply* for the Throttling - SLA-based policy.
+
The *Apply "Throttling - SLA based" policy* dialog appears.
+
image::walkthrough-manage-e6710.png[walkthrough-manage-e6710,height=631,width=493]
+
. Accept the defaults, click *Apply*.
+
. Click *Apply* for the Rate limiting - SLA-based policy.
+
The *Apply "Rate limited - SLA based" policy* dialog appears.
+
. Accept the defaults, click *Apply*.
. On the list of available policies, click the *Raml snippet* for either of the policies you applied.
. Follow instructions to add traits to RAML for enforcing the policies: Open API Designer and edit the RAML as follows:
+
* Add a section called "traits:" at the root level to define query parameters:

[source,yaml,linenums]
----
traits:
  - client-id-required:
      queryParameters:
       client_id:
        type: string
      client_secret:
        type: string
----
+
* Reference the trait in each of the methods to specify that each of the methods require these query parameters. After each method in the RAML file, add **is: [rate-limited]**. For example:
+
[source,yaml,linenums]
----
/products:
  get:
    is: [client-id-required]
    description: Gets a list of all the inventory products.
----

== Next

link:/anypoint-platform-for-apis/walkthrough-engage[Publish an API Portal] so users can find your API, read its documentation, and request access to it.
