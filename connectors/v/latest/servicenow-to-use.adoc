= To Use the ServiceNow Connector
:keywords: anypoint studio, connector, endpoint, servicenow, http
:imagesdir: ./_images

This example describes the general configuration steps for using a ServiceNow operation in a Mule app.

. Create a Mule application as a Design Center or Studio 7 Mule project.
+
. Add and configure a trigger, such as the HTTP Listener or Scheduler, for a flow in your app.
+
You can accept the default settings for the HTTP Listener or Scheduler and provide any required values.
+
. If you need to check your ServiceNow credentials, you can authenticate against the ServiceNow server (endpoint) by defining an HTTP Request component with BASIC Auth credentials.
. Add the ServiceNow-Invoke operation.
. From the Invoke operation, configure and save a connection to the ServiceNow server.
+
[%header%autowidth.spread]
|===
|Field |Description
|Username |Enter the username to log in with.
|Password |Enter the corresponding password.
|Service address | WSDL endpoint
|Service Now version | ServiceNow version (Instabul default)
|User tables| Custom tables for logged user.
|===
+
image:servicenow-global-element-props.png[servicenow-config]
+
. In the operation's General side-tab, provide any required values to Web Service Configuration.

The ServiceNow Connector Technical Reference provides details on the configuration options.

== Configure in Studio

. Drag and drop the connector to the Studio Canvas.
. Configure the Global element for the connector
+
// image::configStudio1.png[config connector]
+
[%header%autowidth.spread]
|===
|Field |Description
|Username |Enter the username to log in with.
|Password |Enter the corresponding password.
|Service address | WSDL endpoint
|Service Now version | ServiceNow version (Instabul default)
|User tables| Custom tables for logged user.
|===
. Go to Transport Tab and configure a Basic HTTP Transport
+
// image::configStudio2.png[config connector 2]
+
[%header%autowidth.spread]
|===
|Field |Description
|Username |Enter the username to log in with.
|Password |Enter the corresponding password.
|===

[Studio image of Configuration screen]

== Use Case: Studio

=== Get ServiceNow Incident Table Keys

Create a Mule flow to get keys from the Incident table in your ServiceNow instance.

// image::flow.png[flow example]

. Create a new Mule application in Anypoint Studio and select an HTTP Listener as a source in the new flow.
. Add a new HTTP Listener Configuration global element:
.. Specify Host as 0.0.0.0 and port as 8081.
.. Click Save.
. Assign your new  Global configuration to your HTTP Listener.
. Fill in HTTP Listener path with `/incident/get` value.
. Drag and drop a new ServiceNow component on the flow.
. Configure the ServiceNow connector global element with its environment values under General tab.
. Go to Transport tab and select a new Transport Configuration with `Basic Auth Http Message Dispatcher Provider`. Fill Username and Password fields with the proper values.
+
. Click Test to confirm that Mule can connect with your ServiceNow instance. If the connection is successful, click OK to save the configurations of the global element. If unsuccessful, revise or correct any incorrect parameters, and test again.
. In the properties editor of ServiceNow connector, set Service to `incident` and the Operation to `getKeys`:
// +
// image:operation.png[servicenow-getkeys-config]
+
. Copy the following content under *Message -> Body* section
+
[source,code]
----
<inc:getKeys xmlns:inc="http://www.service-now.com/incident">
    <inc:number>?</inc:number>
</inc:getKeys>
----
+
. Save and run the project as a Mule Application.
. To test the app, navigate to `+http://127.0.0.1:8081/incident/get+`


== Use Case: XML

[source,code]
----
<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:netsuite="http://www.mulesoft.org/schema/mule/netsuite" xmlns:servicenow="http://www.mulesoft.org/schema/mule/servicenow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd http://www.mulesoft.org/schema/mule/netsuite http://www.mulesoft.org/schema/mule/netsuite/current/mule-netsuite.xsd http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd http://www.mulesoft.org/schema/mule/servicenow http://www.mulesoft.org/schema/mule/servicenow/current/mule-servicenow.xsd">
   <configuration-properties file="mule-app.properties" doc:name="Configuration properties" />
   <http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" doc:id="7ab4c27b-8bb3-4dc8-bb1c-7633518a5a3b">
      <http:listener-connection host="0.0.0.0" port="8081" />
   </http:listener-config>
   <servicenow:config name="ServiceNow_Config" doc:name="ServiceNow Config" doc:id="b5ddd9e5-9b00-4a7a-83bd-6c945285050e">
      <servicenow:basic-connection username="${servicenow.username}" password="${servicenow.password}" serviceAddress="${servicenow.address}">
         <servicenow:transport>
            <servicenow:basic-auth-http-message-dispatcher-provider username="${servicenow.username}" password="${servicenow.password}" />
         </servicenow:transport>
      </servicenow:basic-connection>
   </servicenow:config>
   <flow name="testFlow" doc:id="1e5e1844-9cf3-4184-91f2-9aee21c0e4a2">
      <http:listener config-ref="HTTP_Listener_config" path="/incident/get" doc:name="Listener" doc:id="f6b45517-0b65-4157-9a48-5de4b807bdd6" />
      <servicenow:invoke service="incident" operation="getKeys" doc:name="Invoke" doc:id="a9a270b8-ed36-439b-a572-54d9fe4b4f1a" config-ref="ServiceNow_Config">
         <servicenow:message>
            <servicenow:body><![CDATA[<inc:getKeys xmlns:inc="http://www.service-now.com/incident">
    <inc:number>?</inc:number>
</inc:getKeys>]]></servicenow:body>
         </servicenow:message>
      </servicenow:invoke>
   </flow>
</mule>
----

== See Also

* link:/connectors/servicenow-about[About the ServiceNow Connector]
* link:/connectors/servicenow-reference[ServiceNow Connector Technical Reference]
