= Mule Runtime 4.0 Release Notes
:keywords: mule, 4.0, runtime, release notes

*November 19, 2017*

This is an Early Access release of Mule 4. We do not recommend that existing Mule customers migrate applications to Mule 4 at this time. This release is suitable for the following scenarios:

* Users of the Design Center web-based flow designer who are deploying on CloudHub, where this is a GA-supported release.
* Customers who are interested in testing upcoming enhancements to Mule Runtime.
* Partners and community who are updating their Mule connectors and other materials

== What’s new?
This release contains only bug fixes. See link:/mule-user-guide/v/4.0/mule-runtime-updates[What’s New in Mule 4] for a complete overview of what’s included in Mule 4.

== Fixed Issues

The issues have been fixed since the Mule 4 RC.

[%header,cols="20,80"]
|===
| Issue | Description

| MULE-13956
| Mule should not log OVERLOAD errors caused by flow back-pressure at ERROR level

| MULE-13881
| JMS reconnection strategies do not seem to work

| MULE-13873
| SFDC Connector failing while trying to delete records by id

| MULE-13871
| VM consume operation collides with listener

| MULE-13859
| Streaming OutOfMemoryError on Soak Testing

| MULE-13840
| Bad performance in DefaultSourceCompletionHandler#createResponseParameters

| MULE-13759
| JMS Publish operation throws a JMS:ILLEGAL_BODY error type while overriding ContentType or Encoding

| MULE-13747
| Batch: "ConcurrentModificationException" when payload or variable of type "ManagedCursorIterator" is sent between batch steps

| MULE-13745
| Valid XML names throw an "Invalid Name" exception

| MULE-13742
| Operations in SC are missing displayName

| MULE-13740
| Invalid error model in validation module

| MULE-13739
| Wrong HTTP and WSC stereotypes

| MULE-13694
| Provide support for fetching all the xsd dependencies from a xsd file

| MULE-13687
| ExtensionModel DTO missing the ErrorModel attribute

| MULE-13657
| DataBase connector throws a DB:QUERY_EXECUTION error type when cannot get a connection

| MULE-13632
| Exception thrown when doing a hot redeploy of an app using the derby driver

| MULE-13629
| DB extension module not handling 'null' values as input parameters in stored procedures

| MULE-13594
| Issue reading properties for runtime and tooling

| MULE-13576
| Stackoverflow error when getting notifications for WSC

| MULE-13571
| Request hanged if response statusCode is less than 200

| MULE-13563
| Request hanged when overriding attributes in the error handler of a policy, without setting status code

| MULE-13557
| Jar content cannot be read by URL.openStream() on Windows

| MULE-13526
| Policy hangs when using more than one policy

| MULE-13521
| JMS does not communicate properly it's ExternalLibs

| MULE-13506
| ConfigurationComponentLocator.findAll does not return all components

| MULE-13505
| Registry NPE looking for componentLocation

| MULE-13502
| OutOfMemory using For Each to iterate a JSON

| MULE-13467
| ArtifactSerializationService is generating trustStore parameter of tls context with camelCase format

| MULE-13329
| WSC fails to resolve metadata for wsdl.

| MULE-13202
| Object bean showing error message with null references

| MULE-12953
| Mule Core operations don't expose any error models

| MULE-12935
| Try's scope not handled correctly on Mesage History

| MULE-12896
| Metadata: json schemas with import do not work unless they have a full path

| MULE-12892
| [DB] Wrong error message when bulk-insert operation fails

| EE-5760
| BatchJobInstance does not wait for all dispatched records to finish before shutting down

| EE-5742
| Batch aggregator fails when flushing the records.
|===

== Known Issues

[%header,cols="20,80"]
|===
| Issue | Description
| MULE-14101
| JCo initialization error when using SAP operations

| MULE-14075
| Failure to resolve DataSense when using JMS with a JNDI connection factory

| MULE-14020
| FTP connector fails to write when called from a MUnit test

| MULE-13964
| SAXParseException when deploying apps using parallel deployment

| EE-5523
| IllegalMonitorStateException when trying to dispose HA module
|===

== Fixed Issues that were present in 3.x

[%header,cols="20,80"]
|===
| Issue | Description

| MULE-13954
| Tests using TransactedPollingMessageReceiver generate very big logs

| MULE-13946
| Cannot handle multipart data with repeated names

| MULE-13935
| In Message Filter, unacceptedMessageProcessor is not being notified

| MULE-13788
| Oauth authentication using refreshTokenWhen parameter is not retaining attachments and properties

| MULE-13738
| Is not possble to tell in some DeploymentListener notifications if they're fired by an app or domain

| MULE-13723
| Support out-of-browser applications in OAuth module redirect url

| MULE-13356
| Application's log config logs to console when no appender is configured

| MULE-12559
| BlockingTransferInputStream should implement read(byte[] b, int off, int len)

| MULE-12411
| Benchmarking a simple proxy in a big instance, load threads hangs waiting for the request to end.

| MULE-11331
| Statements leaked when auto key generation fails while executing stored procedure

| MULE-9562
| mule udp connector create new socket object for same address

| MULE-9290
| Extensions fail to build if parameter has a wildcard generic

| MULE-9203
| MTOM attachments not working with WS consumer and HTTP listener

| MULE-9200
| Fix context shutdown test cases with http:listener

| EE-5760
| BatchJobInstance does not wait for all dispatched records to finish before shutting down
| EE-5214
| Delayed startup on macOS Sierra

| EE-4927
| Cluster quorum - uncaught NumberFormatException when quorum size has an illegal value
|===

== Gateway 4
Gateway leverages many of the improvements added in Mule 4. See link:/mule-user-guide/v/4.0/mule-runtime-updates[What’s New in Mule 4] for a complete overview.

* There is classloading isolation between the policies, the application and the runtime.
* Policies can be distributed outside of the runtime, providing frictionless upgrades
* All policies are non-blocking.
* All policies can be ordered. The only policy with a fixed order is CORS that it is executed first.
* Resource-level policy support has been extended to any HTTP API and not restricted to RAML based APIs.
* Custom policies can leverage Mule core concepts and language. See link:https://docs.mulesoft.com/api-manager/custom-policy-4-reference[Custom Policy General Reference] (on `+https://docs.mulesoft.com/+`).

Note that Mule 4 is only supported on the new API Manager. See new API Manager documentation, link:https://docs.mulesoft.com/api-manager/configure-auto-discovery-new-task#configuration-xml-element-for-mule-4[Configuration XML Element for Mule 4] (on `+https://docs.mulesoft.com/+`), for how to configure API Gateway.

=== Not supported on Early Access

* Exporting API Analytics to external analytics tool.
* Auto-generating and deploying proxies from API Manager.
* Throttling and Throttling SLA Based policies.
* Studio 7 doesn’t offer support for Gateway.
